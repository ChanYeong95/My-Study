## 대용량 시스템

- 3 Tier Architecture
  > 클라이언트 - 서버 - 데이터베이스
    - 가장 기본적인 웹의 형태
    - 복잡도의 증가로 서버는 `웹 서버`와 `웹 애플리케이션 서버`로 분리
        - 웹 서버: 정적인 데이터 전달
        - 웹 애플리케이션 서버: 동적인 콘텐츠 전달


- 관심사의 분리 / 관측 가능한 시스템 / 효율적인 리소스 사용
    - 역할에 맞는 최적화 기법 사용에 자유롭다.
    - 문제의 범위를 줄일 수 있다.
    - 복잡도 증가

## 데이터베이스가 병목인 이유

```markdown
- 스케일 업(Scale-Up)
    - 기존 서버의 성능을 높여 시스템 확장
    - 유지 보수가 쉽다.
    - 확장성에 제약이 있다.

- 스케일 아웃(Scale-Out)
    - 서버의 수를 증가시켜 시스템 확장
    - 부하 분산 필요
    - 여러 대의 서버 관리에 따른 유지 보수에 어려움이 있다.
    - 장애 탄력성이 있다.
```

- 스케일 아웃에는 상태가 없어야 한다.
- 하지만 데이터베이스는 데이터라는 상태를 관리한다.
- 따라서 데이터베이스를 스케일 아웃 하기 위해서는 많은 비용이 필요하다.

## 대용량 시스템 아키텍쳐

#### 어려운 이유

- 여러 개의 서버 또는 데이터베이스를 사용한다.
- 데이터의 일관성을 보장해야 한다.
- 코드 한 줄이 데이터에 미치는 영향의 범위가 커진다.
- 여러 서비스들이 얽혀있어, 시스템 복잡도가 높다.

#### 필수조건

- 고가용성
    - 언제든 서비스를 이용할 수 있다.
- 확장성
    - 시스템이 비대해짐에 따라 증가하는 데이터와 트래픽에 대응할 수 있어야 한다.
- 관측가능성
    - 문제가 생겼을 때 빠르게 인지할 수 있어야 하고, 문제의 범위를 최소화할 수 있어야 한다.

#### 발전

1. 클라이언트 - 서버 - 데이터베이스
2. 서버 스케일 아웃 + 로드 벨런서(부하 분산)
3. 캐싱 도입
    - 고려 사항
        - 로컬 캐시
            - 각 서버 메모리에 데이터 캐싱
        - 글로벌 캐시
            - 여러 서버들이 하나의 캐시를 공유
        - 캐시 주기, 만료 정책 등 ..
4. 비동기 큐 적용
    - 대외기관 연동 부분을 클라이언트의 요청에서 제외
    - 대외기관의 적정 TPS에 맞게 요청량 제어
